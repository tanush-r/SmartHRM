<div class="card shadow-lg border-0 rounded-lg fullscreen-card">
  <div class="row justify-content-center">
    <div class="col-md-6" [ngClass]="{ 'move-left': isFileViewActive }">
      <div
        class="card shadow-lg border-0 rounded-lg"
        style="
          height: auto;
          max-width: 500px;
          border: 1px solid #ffffff;
          margin-top: 50px;
        "
      >
        <div class="card-body p-4" style="background-color: #f5faff">
          <h6 class="card-title text-center mb-4" style="font-weight: bold">
            Upload JD
          </h6>
          <div class="form-group mb-4">
            <label for="clientDropdown" class="form-label">Client Name</label>
            <div class="input-group">
              <select
                class="form-select"
                id="clientDropdown"
                [(ngModel)]="selectedClientName"
                required
                aria-label="Select Client"
              >
                <option value="" disabled selected>Select Client</option>
                <option *ngFor="let client of clients" [value]="client.cl_name">
                  {{ client.cl_name }}
                </option>
              </select>
              <button
                class="btn btn-primary"
                type="button"
                (click)="addClient()"
                data-bs-toggle="tooltip"
                title="Add new client"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
            </div>
          </div>
          <!-- File Upload Section -->
          <div
            class="upload-container text-center p-4 mb-4"
            style="
              position: relative;
              border: 2px dashed #0747a6;
              background-color: #eaf2ff;
            "
          >
            <input
              type="file"
              #fileInput
              (change)="onFileChange($event)"
              style="display: none"
              accept=".pdf,.docx"
            />
            <label
              for="fileInput"
              (click)="triggerFileUpload()"
              style="cursor: pointer"
            >
              <i
                class="bi bi-cloud-upload"
                style="font-size: 48px; color: #0747a6"
              ></i>
              <p class="mt-2">
                {{ fileName || "Upload Job Descriptions (JDs)" }}
              </p>
            </label>
            <span
              class="icon-eye"
              (click)="toggleFileView()"
              style="
                position: absolute;
                top: 10px;
                right: 10px;
                font-size: 24px;
                cursor: pointer;
              "
            >
              <i class="fas fa-eye"></i>
            </span>
            <ng-container *ngIf="!isUploading">
              <ng-container *ngIf="uploadStatus === 'success'">
                <i
                  class="bi bi-check-circle"
                  style="font-size: 48px; color: green"
                ></i>
                <p class="mt-2">{{ fileName }}</p>
              </ng-container>
              <ng-container *ngIf="uploadStatus === 'error'">
                <i
                  class="bi bi-x-circle"
                  style="font-size: 48px; color: red"
                ></i>
                <p class="mt-2">Upload failed. Try again.</p>
              </ng-container>
              <ng-container *ngIf="!uploadStatus && !fileName">
                <i
                  class="bi bi-cloud-upload"
                  style="font-size: 48px; color: #0747a6"
                ></i>
                <p class="mt-2">Upload Job Descriptions (JDs)</p>
              </ng-container>
            </ng-container>
            <!-- Loading Indicator -->
            <ng-container *ngIf="isUploading">
              <i
                class="bi bi-hourglass-split"
                style="font-size: 48px; color: #0747a6"
              ></i>
              <p class="mt-2">Uploading...</p>
            </ng-container>
          </div>
          <!-- Submit Button -->
          <div class="form-group text-center">
            <button
              type="button"
              class="btn btn-success px-4"
              (click)="submitForm()"
            >
              Submit
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Right: Uploaded File View Component -->
    <div class="col-md-6" *ngIf="isFileViewActive">
      <div class="row">
        <div class="col-md-12 text-center" style="margin-top: 20px">
          <h6>Uploaded JD Preview</h6>
          <div class="controls mb-3">
            <button (click)="zoomOut()">-</button>
            <span>Zoom: {{ zoomLevel * 100 | number : "1.0-0" }}%</span>
            <button (click)="zoomIn()">+</button>
          </div>
          <!-- File Preview -->
          <div *ngIf="isPdfFile && pdfSrc; else loadingJD">
            <pdf-viewer
              [src]="pdfSrc"
              [original-size]="false"
              [show-all]="true"
              [zoom]="zoomLevel"
              style="height: 550px; width: 100%"
            ></pdf-viewer>
          </div>
          <div *ngIf="isDocxFile && docSrc; else loadingJD">
            <ngx-doc-viewer
              [url]="docSrc"
              viewer="google"
              style="width: 100%; height: 550px"
            ></ngx-doc-viewer>
          </div>
          <ng-template #loadingJD> </ng-template>
          <button (click)="toggleFileView()" class="btn btn-secondary mt-3">
            Close Preview
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Optional Bootstrap Tooltip Activation -->
<script>
  var tooltipTriggerList = [].slice.call(
    document.querySelectorAll('[data-bs-toggle="tooltip"]')
  );
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
  });
</script>